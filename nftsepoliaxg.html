<!DOCTYPE html>
<html>
<head>
    <title>Sepolia NFTä¸€é”®æŸ¥è¯¢å™¨</title>
    <style>
        body { font-family: Arial; margin: 40px; background: #f5f5f5; }
        .container { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); max-width: 800px; margin: auto; }
        h2 { color: #333; }
        button { background: #4CAF50; color: white; border: none; padding: 12px 25px; border-radius: 8px; font-size: 16px; cursor: pointer; margin: 10px 0; }
        button:hover { background: #45a049; }
        .nft-card { border: 1px solid #e0e0e0; padding: 20px; margin: 15px 0; border-radius: 10px; background: #fafafa; }
        .nft-name { font-weight: bold; color: #2c3e50; font-size: 18px; }
        .nft-collection { color: #7f8c8d; margin: 5px 0; }
        .nft-id { background: #e8f4fc; padding: 5px 10px; border-radius: 5px; display: inline-block; margin-top: 10px; }
        .loading, .error { padding: 15px; margin: 15px 0; border-radius: 8px; }
        .loading { background: #e3f2fd; color: #1565c0; }
        .error { background: #ffebee; color: #c62828; }
        .success { background: #e8f5e9; color: #2e7d32; padding: 15px; border-radius: 8px; margin: 15px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h2>ğŸ” Sepolia NFTä¸€é”®æŸ¥è¯¢å™¨</h2>
        <p>è¾“å…¥ä½ çš„é’±åŒ…åœ°å€ï¼Œä½¿ç”¨Alchemy APIç›´æ¥æŸ¥è¯¢Sepoliaé“¾ä¸ŠæŒæœ‰çš„NFTã€‚</p>
        
        <input type="text" id="walletInput" placeholder="è¾“å…¥Sepoliaé’±åŒ…åœ°å€ (0x...)" value="<ä½ çš„é’±åŒ…åœ°å€>" style="width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;">
        <button onclick="fetchNFTs()">å¼€å§‹æŸ¥è¯¢æˆ‘çš„NFT</button>
        
        <div id="loading" class="loading" style="display:none;">
            <p>æ­£åœ¨ä»SepoliaåŒºå—é“¾æŸ¥è¯¢æ•°æ®ï¼Œè¯·ç¨å€™...</p>
        </div>
        
        <div id="result"></div>
    </div>

    <script>
        // Alchemyæä¾›çš„Sepoliaæµ‹è¯•ç½‘NFT APIç«¯ç‚¹ (æ— éœ€APIå¯†é’¥çš„å…¬å¼€demoç‰ˆ)
        const ALCHEMY_API_URL = "https://eth-sepolia.g.alchemy.com/nft/v2/demo/getNFTs";

        async function fetchNFTs() {
            const walletAddress = document.getElementById('walletInput').value.trim();
            const resultDiv = document.getElementById('result');
            const loadingDiv = document.getElementById('loading');

            // 1. éªŒè¯åœ°å€æ ¼å¼
            if (!walletAddress.startsWith('0x') || walletAddress.length !== 42) {
                resultDiv.innerHTML = `<div class="error">âŒ è¯·è¾“å…¥æœ‰æ•ˆçš„ä»¥å¤ªåŠåœ°å€ (ä»¥0xå¼€å¤´ï¼Œ42ä½å­—ç¬¦)</div>`;
                return;
            }

            // 2. æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            resultDiv.innerHTML = '';
            loadingDiv.style.display = 'block';

            try {
                // 3. æ„å»ºAPIè¯·æ±‚URL
                const apiUrl = `${ALCHEMY_API_URL}?owner=${walletAddress}&withMetadata=true`;

                // 4. å‘èµ·è¯·æ±‚
                const response = await fetch(apiUrl);
                
                if (!response.ok) {
                    throw new Error(`ç½‘ç»œè¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç : ${response.status}`);
                }

                const data = await response.json();

                // 5. å¤„ç†å¹¶æ˜¾ç¤ºç»“æœ
                loadingDiv.style.display = 'none';

                // æ£€æŸ¥æ˜¯å¦æœ‰NFT
                const ownedNFTs = data.ownedNfts || [];
                
                if (ownedNFTs.length === 0) {
                    resultDiv.innerHTML = `<div class="error">ğŸ” åœ¨è¯¥åœ°å€ä¸‹æœªæ‰¾åˆ°ä»»ä½•NFTã€‚è¯·ç¡®ä¿ï¼š<br>1. åœ°å€æ— è¯¯ï¼›<br>2. è¯¥åœ°å€åœ¨Sepoliaæµ‹è¯•ç½‘ä¸Šç¡®å®æŒæœ‰NFTã€‚</div>`;
                    return;
                }

                // æ˜¾ç¤ºæˆåŠŸä¿¡æ¯å’Œç»Ÿè®¡
                resultDiv.innerHTML = `<div class="success">âœ… æˆåŠŸæ‰¾åˆ° <strong>${ownedNFTs.length}</strong> ä¸ªNFTèµ„äº§</div>`;

                // æ˜¾ç¤ºæ¯ä¸ªNFTçš„è¯¦ç»†ä¿¡æ¯
                ownedNFTs.forEach(nft => {
                    // å®‰å…¨åœ°è·å–NFTåç§°
                    const name = nft.title || 
                                nft.metadata?.name || 
                                `${nft.contractMetadata?.symbol || 'NFT'} #${nft.id.tokenId}`;
                    
                    // è·å–å›¾ç‰‡ï¼ˆä¼˜å…ˆä½¿ç”¨å¯è®¿é—®çš„æ ¼å¼ï¼‰
                    const image = nft.media?.[0]?.gateway || 
                                 nft.media?.[0]?.thumbnail || 
                                 nft.metadata?.image || 
                                 'https://via.placeholder.com/300x300/e0e0e0/666?text=NFT+Image';

                    const nftCard = document.createElement('div');
                    nftCard.className = 'nft-card';
                    nftCard.innerHTML = `
                        <div class="nft-name">${name}</div>
                        <div class="nft-collection">
                            <strong>é›†åˆï¼š</strong>${nft.contractMetadata?.name || 'æœªçŸ¥é›†åˆ'}
                            (${nft.contractMetadata?.symbol || 'â€”'})
                        </div>
                        <div><strong>åˆçº¦åœ°å€ï¼š</strong>${nft.contract.address}</div>
                        <div><strong>Token IDï¼š</strong><span class="nft-id">${nft.id.tokenId}</span></div>
                        <div style="margin-top: 15px;">
                            <img src="${image}" 
                                 alt="${name}" 
                                 style="max-width: 200px; max-height: 200px; border-radius: 5px;"
                                 onerror="this.src='https://via.placeholder.com/200x200/e0e0e0/666?text=Image+Not+Available'">
                        </div>
                        <hr style="margin: 15px 0; border: none; border-top: 1px solid #eee;">
                    `;
                    resultDiv.appendChild(nftCard);
                });

            } catch (error) {
                // 6. é”™è¯¯å¤„ç†
                loadingDiv.style.display = 'none';
                console.error('æŸ¥è¯¢è¿‡ç¨‹ä¸­å‡ºé”™:', error);
                resultDiv.innerHTML = `<div class="error">âŒ æŸ¥è¯¢å¤±è´¥: ${error.message}<br>å¯èƒ½åŸå› ï¼š<br>1. ç½‘ç»œè¿æ¥é—®é¢˜ï¼›<br>2. APIæœåŠ¡æš‚æ—¶ä¸å¯ç”¨ã€‚</div>`;
            }
        }

        // é¡µé¢åŠ è½½æ—¶ï¼Œå¦‚æœåœ°å€æ¡†å·²æœ‰å†…å®¹ï¼Œåˆ™è‡ªåŠ¨æŸ¥è¯¢
        window.onload = function() {
            const walletInput = document.getElementById('walletInput');
            if (walletInput.value && walletInput.value.startsWith('0x') && walletInput.value.length === 42) {
                fetchNFTs();
            }
        };
    </script>
</body>
</html>